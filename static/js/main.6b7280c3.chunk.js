(this["webpackJsonpgif-search-engine"]=this["webpackJsonpgif-search-engine"]||[]).push([[0],{101:function(e,t,a){e.exports=a(116)},116:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(6),c=a.n(o),l=a(14),i=a(9),u=a(149),s=Object(u.a)((function(e){return{input:{display:"block",fontSize:"22px",height:"50px",margin:"0 auto",textAlign:"center",width:"50%"}}})),m=function(e){var t=s();return r.a.createElement("input",{className:t.input,onChange:e.onChange})},g=a(58),d=a(59),f=a(65),h=a(64),v=a(120),p=a(168),b=a(118),E=a(164),O=a(166),j=a(165),w=a(167),S=a(151),y=a(63),C=a.n(y),x=a(87),I=a.n(x),N=a(18),k=a(85),L=a.n(k),F=a(153),A=a(154),T=a(155),_=a(156),z=a(157),R=a(158),B=a(159),P=a(160),q=a(161),G=a(162),J=a(163),U=Object(u.a)((function(){return{popover:{background:"transparent"},share:{margin:"10px"}}})),D=function(e){var t=Object(n.useState)(null),a=Object(l.a)(t,2),o=a[0],c=a[1],i=Boolean(o),u=i?"simple-popover":void 0,s=e.url,m=U();return r.a.createElement("div",null,r.a.createElement(S.a,{"aria-label":"share",onClick:function(e){c(e.currentTarget)}},r.a.createElement(L.a,null)),r.a.createElement(F.a,{id:u,open:i,anchorEl:o,onClose:function(){c(null)},anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},PaperProps:{style:{backgroundColor:"transparent",boxShadow:"none"}}},r.a.createElement("div",null,r.a.createElement(A.a,{url:s},r.a.createElement(T.a,{className:m.popover,size:32,round:!0})),r.a.createElement(_.a,{url:s},r.a.createElement(z.a,{size:32,round:!0})),r.a.createElement(R.a,{url:s},r.a.createElement(B.a,{size:32,round:!0})),r.a.createElement(P.a,{url:s},r.a.createElement(q.a,{size:32,round:!0})),r.a.createElement(G.a,{url:s},r.a.createElement(J.a,{size:32,round:!0})))))},V=a(182),W="LOGIN",H="LOGOUT",M="ADD_FAVORITE",K="REMOVE_FAVORITE",Q=Object(u.a)((function(e){return{root:function(e){return{maxWidth:"80%",width:e.width}},media:function(e){return{height:e.height,width:e.width}}}})),X=Object(N.b)((function(e){var t=e.auth.user;return{user:t,favorites:e.favorites[t]?e.favorites[t]:{}}}),(function(e){return{addFavorite:function(t,a){return e(function(e,t){return{type:M,user:e,item:t}}(t,a))},removeFavorite:function(t,a){return e(function(e,t){return{type:K,user:e,item:t}}(t,a))}}}))((function(e){var t=e.data,a=e.user,o=e.favorites;console.log(t);var c=t.title,i=t.date,u=t.images,s=t.originalSrc,m=Object(n.useState)(o.hasOwnProperty(s)),g=Object(l.a)(m,2),d=g[0],f=g[1];console.log(o),console.log(s),console.log(d);var h,v,p,b=function(){console.log("add fav"),d||(e.addFavorite(a,t),f(!0))},y=function(){console.log("remove fav"),d&&(e.removeFavorite(a,t),f(!1))},x=t.user;x?(h=x.username,v=x.avatar_url,p=x.profile_url):(h="",v="/default_avatar.png",p="");var N=u.downsized.url,k=Q({height:t.height,width:t.width});return r.a.createElement(E.a,{className:k.root},r.a.createElement("a",{href:N,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(j.a,{className:k.media,image:N})),r.a.createElement(O.a,{avatar:r.a.createElement("a",{href:p,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(V.a,{"aria-label":"avatar",alt:h,src:v})),title:r.a.createElement("div",null,r.a.createElement("div",null,c),r.a.createElement("div",null,h)),subheader:i}),r.a.createElement(w.a,{disableSpacing:!0},d?r.a.createElement(S.a,{"aria-label":"favorited",onClick:y},r.a.createElement(C.a,null)):r.a.createElement(S.a,{"aria-label":"add to favorites",onClick:b},r.a.createElement(I.a,null)),r.a.createElement(D,{url:N})))})),Y=Object(u.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),$=function(e){var t=e.open,a=e.handleClose,n=e.data,o=Y();return r.a.createElement("div",null,r.a.createElement(v.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:o.modal,open:t,onClose:a,closeAfterTransition:!0,BackdropComponent:p.a,BackdropProps:{timeout:500}},r.a.createElement(b.a,{in:t},r.a.createElement(X,{className:o.paper,data:n}))))},Z=function(e){Object(f.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(g.a)(this,a),(n=t.call(this,e)).handleOpen=function(){n.setState({open:!0})},n.handleClose=function(){n.setState({open:!1})},n.state={open:!1},n}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.image,a=e.forwardedRef,n=e.margin,o=t.height,c=t.width,l=t.src,i=t.title,u={height:o,width:c,margin:n},s={height:o,width:c,src:l};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{ref:a,style:u},r.a.createElement("img",Object.assign({},s,{alt:i,onClick:this.handleOpen}))),r.a.createElement($,{open:this.state.open,handleClose:this.handleClose,data:t}))}}]),a}(r.a.Component),ee=r.a.forwardRef((function(e,t){return r.a.createElement(Z,Object.assign({},e,{forwardedRef:t}))})),te=a(89),ae=function(e){var t=e.gifs,a=e.forwardedRef,o=Object(n.useCallback)((function(e){var n=e.index,o=e.photo;return n===t.length-1?r.a.createElement(ee,{index:n,image:o,margin:"1px",ref:a}):r.a.createElement(ee,{index:n,image:o,margin:"1px"})}));return r.a.createElement("div",null,r.a.createElement(te.a,{photos:t,renderImage:o}),r.a.createElement("div",{id:"page-bottom-boundary",style:{border:"1px solid red"}}))},ne=r.a.forwardRef((function(e,t){return r.a.createElement(ae,Object.assign({},e,{forwardedRef:t}))})),re=a(169),oe=function(e,t){var a=Object(n.useState)(e),r=Object(l.a)(a,2),o=r[0],c=r[1];return Object(n.useEffect)((function(){var a=setTimeout((function(){c(e)}),t);return function(){console.log("clean up"),clearTimeout(a)}}),[e,t]),o},ce=Object(u.a)((function(e){return{root:{margin:"3em auto",width:"90%"},searchBar:{margin:e.spacing(3,2)},list:{margin:e.spacing(2)}}})),le=[],ie=Object(i.g)((function(){var e=Object(n.useState)(le),t=Object(l.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),i=Object(l.a)(c,2),u=i[0],s=i[1],g=Object(n.useState)(10),d=Object(l.a)(g,2),f=d[0],h=(d[1],Object(n.useState)(0)),v=Object(l.a)(h,2),p=v[0],b=v[1],E=Object(n.useState)(!1),O=Object(l.a)(E,2),j=O[0],w=O[1],S=oe(u,250),y=function(){var e=function(){var e,t,a="?api_key=".concat("d9QEcr130V2Auel0mELTeiIKxfBIpuqX");""===u?(e="trending",t=""):(e="search",t="&q=".concat(u.replace(/\s/g,"+")));var n="&limit=".concat(f),r="&offset=".concat(p*f);return"https://api.giphy.com/v1/gifs/".concat(e).concat(a).concat(t).concat(n).concat(r)}();console.log(e),w(!0),fetch(e).then((function(e){return e.json()})).then((function(e){console.log(e);var t=e.data.map((function(e){var t=e.user,a=e.title,n=e.import_datetime,r=e.images,o=r.fixed_height,c=o.height,l=o.width,i=o.url;return{user:t,title:a,date:n,images:r,height:parseFloat(c),width:parseFloat(l),src:i,originalSrc:e.url}}));o((function(e){return e.concat(t)})),w(!1)})).catch((function(e){return console.log(e)}))};Object(n.useEffect)((function(){o(le),b(0),y()}),[S]),Object(n.useEffect)((function(){0!==p&&y()}),[p]);var C=Object(n.useRef)(),x=Object(n.useCallback)((function(e){j||(C.current&&C.current.disconnect(),C.current=new IntersectionObserver((function(e){e[0].isIntersecting?(console.log("Last element visible"),b(p+1)):console.log("Last element not visible")}),{threshold:1}),e&&C.current.observe(e))}),[j]),I=ce();return r.a.createElement("div",{className:I.root},r.a.createElement("div",{className:I.searchBar},r.a.createElement(m,{onChange:function(e){s(e.target.value)}})),r.a.createElement(re.a,{variant:"middle"}),r.a.createElement("div",{className:I.list},r.a.createElement(ne,{className:I.root,gifs:a,ref:x})))})),ue=a(34),se=function(e){var t=e.component,a=e.isAuthenticated,n=void 0!==a&&a,o=Object(ue.a)(e,["component","isAuthenticated"]);return r.a.createElement(i.b,Object.assign({},o,{render:function(e){return n?r.a.createElement(t,e):r.a.createElement(i.a,{to:"/"})}}))},me=Object(u.a)((function(e){return{root:{margin:"5em auto",width:"90%"}}})),ge=Object(i.g)(Object(N.b)((function(e){var t=e.auth.user;return{favorites:e.favorites[t]?e.favorites[t]:{}}}),null)((function(e){var t=Object.values(e.favorites),a=me();return r.a.createElement("div",{className:a.root},r.a.createElement(ne,{gifs:t}))}))),de=a(24),fe=a(170),he=a(171),ve=a(91),pe=a.n(ve),be=Object(u.a)({root:{width:"100%",position:"fixed",bottom:0}}),Ee=Object(i.g)((function(e){var t=be(),a=r.a.useState(0),n=Object(l.a)(a,2),o=n[0],c=n[1];return r.a.createElement(fe.a,{value:o,onChange:function(e,t){c(t)},showLabels:!0,className:t.root},r.a.createElement(he.a,{label:"Trending",icon:r.a.createElement(pe.a,null),component:de.b,to:"/"}),r.a.createElement(he.a,{label:"Favorites",icon:r.a.createElement(C.a,null),component:de.b,to:"/favorites"}))})),Oe=a(177),je=a(178),we=a(66),Se=a(176),ye=a(173),Ce=a(174),xe=a(172),Ie=Object(u.a)((function(e){return{root:{}}})),Ne=Object(i.g)(Object(N.b)(null,(function(e){return{logout:function(){return e({type:H})}}}))((function(e){var t=Ie();return r.a.createElement(xe.a,{className:t.root,size:"small",color:"primary",onClick:function(){window.gapi.load("auth2",(function(){console.log("loaded gapi");var t=window.gapi.auth2.init({client_id:"".concat("632950261036-lmln5vcmnoarru8rpj4573l1qlsn3qj6.apps.googleusercontent.com")});t.then((function(){console.log("auth2 fully initialized"),t.signOut().then((function(){console.log("after signout from gapi"),t.disconnect(),e.logout(),e.handleLogout(),e.history.push("/")}))}))}))}},"Logout")}))),ke=a(175),Le=function(e){Object(f.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(g.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).initGoogle=function(e){},e.onSuccess=function(t){var a=e.props,n=a.login,r=a.handleLoginSuccess,o=t.getBasicProfile();n({email:o.getEmail(),name:o.getName(),avatar:o.getImageUrl()}),r()},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.gapi.load("auth2",(function(){window.gapi.auth2.init({client_id:"".concat("632950261036-lmln5vcmnoarru8rpj4573l1qlsn3qj6.apps.googleusercontent.com")}).then((function(){window.gapi.signin2.render("google-login",{scope:"profile email",longtitle:!1,theme:"light",onsuccess:e.onSuccess,onfailure:e.props.handleLoginFailure})}))}))}},{key:"render",value:function(){return r.a.createElement("div",{id:"google-login"})}}]),a}(r.a.Component),Fe=Object(i.g)(Object(N.b)(null,(function(e){return{login:function(t){return e(function(e){return{type:W,user:e}}(t))}}}))(Le));function Ae(e){var t=e.children,a=Object(ye.a)();return r.a.createElement(Ce.a,{appear:!1,direction:"down",in:!a},t)}var Te=Object(u.a)((function(e){return{title:{fontStyle:"italic",fontWeight:700},text:{display:"flex",justifyContent:"center",alignItems:"center"},auth:{display:"flex",justifyContent:"flex-end"}}})),_e=Object(N.b)((function(e){return e.auth}),null)((function(e){var t=Te(),a=e.isSignedIn,n=e.user,o=e.handleLogout,c=Object(ue.a)(e,["isSignedIn","user","handleLogout"]);console.log(n.avatar);var l=a?r.a.createElement(r.a.Fragment,null,r.a.createElement(ke.a,{item:!0,xs:1,className:t.auth},r.a.createElement(V.a,{"aria-label":"avatar",src:n.avatar})),r.a.createElement(ke.a,{item:!0,xs:1,className:t.auth},r.a.createElement(Ne,{handleLogout:o}))):r.a.createElement(Fe,c);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Se.a,null),r.a.createElement(Ae,e,r.a.createElement(Oe.a,{position:"sticky",color:"white"},r.a.createElement(je.a,null,r.a.createElement(ke.a,{justify:"space-between",container:!0,spacing:0},r.a.createElement(ke.a,{item:!0,xs:2,className:t.text},r.a.createElement(we.a,{variant:"subtitle2",color:"inherit"},"Powered by GIPHY")),r.a.createElement(ke.a,{item:!0,xs:8,className:t.text},r.a.createElement(we.a,{type:"title",color:"inherit",className:t.title},"G I F S !")),l)))),r.a.createElement(je.a,null))})),ze=a(92),Re=a(179),Be=a(181),Pe="SUCCESS",qe="FAILURE",Ge="LOGOUT",Je="NONE",Ue=a(180),De=function(e){var t=e.alertType,a=e.handleClose;switch(t){case Pe:return r.a.createElement(Ue.a,{onClose:a,severity:"success"},"Login success!");case qe:return r.a.createElement(Ue.a,{onClose:a,severity:"error"},"Error logging in, please try again later");case Ge:return r.a.createElement(Ue.a,{onClose:a,severity:"success"},"Logout success!");default:return r.a.createElement("div",null)}},Ve=Object(ze.a)({typography:{fontFamily:"Helvetica Neue"}}),We=Object(N.b)((function(e){return e.auth}),null)((function(e){var t=Object(n.useState)(!1),a=Object(l.a)(t,2),o=a[0],c=a[1],u=Object(n.useState)(Je),s=Object(l.a)(u,2),m=s[0],g=s[1],d=function(){g(Je),c(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Re.a,{theme:Ve},r.a.createElement(_e,{handleLoginSuccess:function(e){console.log("run handle login success"),g(Pe),c(!0)},handleLoginFailure:function(){console.log("run handle login failure"),g(qe),c(!0)},handleLogout:function(){console.log("run handle logout"),g(Ge),c(!0)}}),r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/",component:ie,isAuthenticated:e.isSignedIn}),r.a.createElement(se,{exact:!0,path:"/favorites",component:ge,isAuthenticated:e.isSignedIn})),r.a.createElement(Be.a,{open:o,autoHideDuration:6e3,onClose:d},r.a.createElement(De,{alertType:m,handleClose:d})),r.a.createElement(Ee,null)))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var He=a(36),Me=a(22),Ke={isSignedIn:!1,user:""},Qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return console.log("signed in!"),Object(Me.a)(Object(Me.a)({},e),{},{isSignedIn:!0,user:t.user});case H:return Object(Me.a)(Object(Me.a)({},e),Ke);default:return e}},Xe=a(72),Ye=a(42),$e={},Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:console.log("add favorite");var a=t.item.originalSrc;return Object(Me.a)(Object(Me.a)({},e),{},Object(Ye.a)({},t.user,Object(Me.a)(Object(Me.a)({},e[t.user]),{},Object(Ye.a)({},a,t.item))));case K:console.log("remove favorite");var n=t.item.originalSrc,r=t.user,o=e[r],c=Object(ue.a)(e,[r].map(Xe.a)),l=(o[n],Object(ue.a)(o,[n].map(Xe.a)));return Object(Me.a)(Object(Me.a)({},c),{},Object(Ye.a)({},t.user,l));default:return e}},et=Object(He.b)({auth:Qe,favorites:Ze}),tt=localStorage.getItem("auth")?JSON.parse(localStorage.getItem("auth")):void 0,at=localStorage.getItem("favorites")?JSON.parse(localStorage.getItem("favorites")):void 0;console.log(at);var nt=Object(He.c)(et,{auth:tt,favorites:at});nt.subscribe((function(){var e=nt.getState().auth,t=nt.getState().favorites;localStorage.setItem("auth",JSON.stringify(e)),localStorage.setItem("favorites",JSON.stringify(t))})),c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N.a,{store:nt},r.a.createElement(de.a,null,r.a.createElement(We,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[101,1,2]]]);
//# sourceMappingURL=main.6b7280c3.chunk.js.map