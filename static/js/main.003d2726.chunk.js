(this["webpackJsonpgif-search-engine"]=this["webpackJsonpgif-search-engine"]||[]).push([[0],{181:function(e,t,a){e.exports=a(254)},254:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(10),o=a.n(i),c=a(17),l=a(28),s=a(297),u=a(330),m=a(302),h=a(163),d=a.n(h),f=Object(s.a)((function(e){return{input:{display:"flex",margin:"0 auto",width:"50%"}}})),g=function(e){var t=f();return r.a.createElement(u.a,{className:t.input,id:"input-with-icon-textfield",label:"Search",placeholder:"Trending",variant:"outlined",onChange:e.onChange,InputProps:{startAdornment:r.a.createElement(m.a,{position:"start"},r.a.createElement(d.a,null))}})},p=a(22),v=a(69),b=a(70),O=a(53),E=a(73),j=a(72),y=a(60),w=a(258),_=a(318),S=a(256),C=a(314),N=a(316),I=a(315),x=a(317),k=a(303),P=a(108),R=a.n(P),T=a(171),L=a.n(T),z=a(23),A=a(169),F=a.n(A),G=a(301),M=a(304),B=a(305),U=a(306),W=a(307),H=a(308),q=a(309),J=a(310),D=a(311),V=a(312),Y=a(313),K=Object(s.a)((function(){return{popover:{background:"transparent"},share:{margin:"10px"}}})),Q=function(e){var t=Object(n.useState)(null),a=Object(l.a)(t,2),i=a[0],o=a[1],c=Boolean(i),s=c?"simple-popover":void 0,u=e.url,m=K();return r.a.createElement("div",null,r.a.createElement(k.a,{"aria-label":"share",onClick:function(e){o(e.currentTarget)}},r.a.createElement(F.a,null)),r.a.createElement(G.a,{id:s,open:c,anchorEl:i,onClose:function(){o(null)},anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},PaperProps:{style:{backgroundColor:"transparent",boxShadow:"none"}}},r.a.createElement("div",null,r.a.createElement(M.a,{url:u},r.a.createElement(B.a,{className:m.popover,size:32,round:!0})),r.a.createElement(U.a,{url:u},r.a.createElement(W.a,{size:32,round:!0})),r.a.createElement(H.a,{url:u},r.a.createElement(q.a,{size:32,round:!0})),r.a.createElement(J.a,{url:u},r.a.createElement(D.a,{size:32,round:!0})),r.a.createElement(V.a,{url:u},r.a.createElement(Y.a,{size:32,round:!0})))))},X=a(333),$="LOGIN",Z="LOGOUT",ee="ADD_FAVORITE",te="REMOVE_FAVORITE",ae="ALERT",ne=function(e){return{type:ae,alertType:e}},re={LOGIN_SUCCESS:"SUCCESS",LOGIN_FAILURE:"FAILURE",LOGOUT:"LOGOUT",LOGIN_PROMPT:"LOGIN_PROMPT",NONE:"NONE"},ie=Object(s.a)((function(e){return{root:function(e){return{maxWidth:"80%",width:e.width}},media:function(e){return{height:e.height,width:e.width}}}})),oe=Object(z.b)((function(e){var t=e.auth,a=t.user;return{user:a,isSignedIn:t.isSignedIn,favorites:e.favorites[a.email]?e.favorites[a.email]:{}}}),(function(e){return{addFavorite:function(t,a){return e(function(e,t){return{type:ee,user:e,item:t}}(t,a))},removeFavorite:function(t,a){return e(function(e,t){return{type:te,user:e,item:t}}(t,a))},alert:function(t){return e(ne(t))}}}))((function(e){var t,a,i,o=e.data,c=e.user,s=e.isSignedIn,u=e.favorites,m=e.addFavorite,h=e.removeFavorite,d=e.alert,f=o.title,g=o.date,p=o.images,v=o.originalSrc,b=Object(n.useState)(u.hasOwnProperty(v)),O=Object(l.a)(b,2),E=O[0],j=O[1],y=function(){return!!s||(d(re.LOGIN_PROMPT),!1)},w=function(){y()&&!E&&(m(c.email,o),j(!0))},_=function(){y()&&E&&(h(c.email,o),j(!1))},S=o.user;S?(t=S.username,a=S.avatar_url,i=S.profile_url):(t="",a="/default_avatar.png",i="");var P=p.downsized.url,T=ie({height:o.height,width:o.width});return r.a.createElement(C.a,{className:T.root},r.a.createElement("a",{href:P,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(I.a,{className:T.media,image:P})),r.a.createElement(N.a,{avatar:r.a.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(X.a,{"aria-label":"avatar",alt:t,src:a})),title:r.a.createElement("div",null,r.a.createElement("div",null,f),r.a.createElement("div",null,t)),subheader:g}),r.a.createElement(x.a,{disableSpacing:!0},E?r.a.createElement(k.a,{"aria-label":"favorited",onClick:_},r.a.createElement(R.a,null)):r.a.createElement(k.a,{"aria-label":"add to favorites",onClick:w},r.a.createElement(L.a,null)),r.a.createElement(Q,{url:P})))})),ce=Object(s.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),le=function(e){var t=e.open,a=e.handleClose,n=e.data,i=ce();return r.a.createElement("div",null,r.a.createElement(w.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:i.modal,open:t,onClose:a,closeAfterTransition:!0,BackdropComponent:_.a,BackdropProps:{timeout:500}},r.a.createElement(S.a,{in:t},r.a.createElement(oe,{className:i.paper,data:n}))))},se=function(e){Object(E.a)(a,e);var t=Object(j.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).handleOpen=function(){n.setState({open:!0})},n.handleClose=function(){n.setState({open:!1})},n.state={open:!1},n}return Object(b.a)(a,[{key:"render",value:function(){var e=this.props,t=e.image,a=e.forwardedRef,n=e.margin,i=t.height,o=t.width,c=t.src,l=t.title,s={height:i,width:o,margin:n},u={height:i,width:o,src:c};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{ref:a,style:s},r.a.createElement("img",Object.assign({},u,{alt:l,onClick:this.handleOpen}))),r.a.createElement(le,{open:this.state.open,handleClose:this.handleClose,data:t}))}}]),a}(r.a.Component),ue=r.a.forwardRef((function(e,t){return r.a.createElement(se,Object.assign({},e,{forwardedRef:t}))})),me=.9*window.innerWidth/3.5,he={columnWidth:me,height:1e3,gutterSize:2,overscanByPixels:0,windowScrollerEnabled:!0},de=function(e){Object(E.a)(a,e);var t=Object(j.a)(a);function a(e){var n;return Object(v.a)(this,a),(n=t.call(this,e)).resetUponNewImages=function(){void 0!==n._masonry&&null!==n._masonry&&(n._cache.clearAll(),n._resetCellPositioner(),n._masonry.clearCellPositions())},n.imageRenderer=function(e,t,a,i){var o=e[t],c=Object(p.a)(Object(p.a)({},o),{},{height:a,width:i});return t===e.length-1?r.a.createElement(ue,{index:t,image:c,margin:"1px",ref:n.props.forwardedRef,key:t}):r.a.createElement(ue,{index:t,image:c,margin:"1px",key:t})},n._columnCount=0,n._cache=new y.c({defaultHeight:250,defaultWidth:me,fixedWidth:!0}),n.state=he,n._cellRenderer=n._cellRenderer.bind(Object(O.a)(n)),n._onResize=n._onResize.bind(Object(O.a)(n)),n._renderAutoSizer=n._renderAutoSizer.bind(Object(O.a)(n)),n._renderMasonry=n._renderMasonry.bind(Object(O.a)(n)),n._setMasonryRef=n._setMasonryRef.bind(Object(O.a)(n)),n}return Object(b.a)(a,[{key:"_calculateColumnCount",value:function(){var e=this.state,t=e.columnWidth,a=e.gutterSize;this._columnCount=Math.floor(this._width/(t+a))}},{key:"_onResize",value:function(e){var t=e.width;this._width=t,this._calculateColumnCount(),this._resetCellPositioner(),this._masonry.recomputeCellPositions()}},{key:"_resetCellPositioner",value:function(){var e=this.state,t=e.columnWidth,a=e.gutterSize;this._cellPositioner.reset({columnCount:this._columnCount,columnWidth:t,spacer:a})}},{key:"render",value:function(){if(0===this.props.images.length)return r.a.createElement("div",null);this.resetUponNewImages();var e=this.state,t=e.height,a=e.overscanByPixels;return e.windowScrollerEnabled?r.a.createElement(y.e,{overscanByPixels:a},this._renderAutoSizer):this._renderAutoSizer({height:t})}},{key:"_renderAutoSizer",value:function(e){var t=e.height,a=e.scrollTop;this._height=t,this._scrollTop=a;var n=this.state.overscanByPixels;return r.a.createElement(y.a,{disableHeight:!0,height:t,onResize:this._onResize,overscanByPixels:n,scrollTop:this._scrollTop},this._renderMasonry)}},{key:"_renderMasonry",value:function(e){var t=e.width;this._width=t,this._calculateColumnCount(),this._initCellPositioner();var a=this.state,n=a.height,i=a.overscanByPixels,o=a.windowScrollerEnabled;return r.a.createElement(y.d,{autoHeight:o,cellCount:this.props.images.length,cellMeasurerCache:this._cache,cellPositioner:this._cellPositioner,cellRenderer:this._cellRenderer,height:o?this._height:n,overscanByPixels:i,ref:this._setMasonryRef,scrollTop:this._scrollTop,width:t})}},{key:"_cellRenderer",value:function(e){var t=e.index,a=e.key,n=e.parent,i=e.style,o=this.props.images;if(!(t>=o.length)){var c=o[t],l=i.width,s=c.height/c.width*l;return r.a.createElement(y.b,{cache:this._cache,index:t,key:a,parent:n},r.a.createElement("div",{style:Object(p.a)(Object(p.a)({},i),{},{maxHeight:s,boxShadow:"0px 0px 1px black"}),key:t},this.imageRenderer(o,t,s,l)))}}},{key:"_initCellPositioner",value:function(){if("undefined"===typeof this._cellPositioner){var e=this.state,t=e.columnWidth,a=e.gutterSize;this._cellPositioner=Object(y.f)({cellMeasurerCache:this._cache,columnCount:this._columnCount,columnWidth:t,spacer:a})}}},{key:"_setMasonryRef",value:function(e){this._masonry=e}}]),a}(r.a.PureComponent),fe=r.a.forwardRef((function(e,t){return r.a.createElement(de,Object.assign({},e,{forwardedRef:t}))})),ge=r.a.memo((function(e){var t=e.gifs,a=e.forwardedRef;return r.a.createElement("div",null,r.a.createElement(fe,{images:t,ref:a}),r.a.createElement("div",{id:"page-bottom-boundary",style:{border:"1px solid red"}}))})),pe=r.a.forwardRef((function(e,t){return r.a.createElement(ge,Object.assign({},e,{forwardedRef:t}))})),ve=a(319),be=function(e,t){var a=Object(n.useState)(e),r=Object(l.a)(a,2),i=r[0],o=r[1];return Object(n.useEffect)((function(){var a=setTimeout((function(){o(e)}),t);return function(){clearTimeout(a)}}),[e,t]),i},Oe=Object(s.a)((function(e){return{root:{margin:"3em auto",width:"90%"},searchBar:{margin:e.spacing(3,2)},list:{margin:e.spacing(2),marginBottom:e.spacing(10)}}})),Ee=[],je=Object(c.g)((function(){var e=Object(n.useState)(Ee),t=Object(l.a)(e,2),a=t[0],i=t[1],o=Object(n.useState)(""),c=Object(l.a)(o,2),s=c[0],u=c[1],m=Object(n.useState)(50),h=Object(l.a)(m,2),d=h[0],f=(h[1],Object(n.useState)(0)),p=Object(l.a)(f,2),v=p[0],b=p[1],O=Object(n.useState)(!1),E=Object(l.a)(O,2),j=E[0],y=E[1],w=be(s,250),_=function(){var e=function(){var e,t,a="?api_key=".concat("d9QEcr130V2Auel0mELTeiIKxfBIpuqX");""===s?(e="trending",t=""):(e="search",t="&q=".concat(s.replace(/\s/g,"+")));var n="&limit=".concat(d),r="&offset=".concat(v*d);return"https://api.giphy.com/v1/gifs/".concat(e).concat(a).concat(t).concat(n).concat(r)}();console.log(e),y(!0),fetch(e).then((function(e){return e.json()})).then((function(e){var t=e.data.map((function(e){var t=e.user,a=e.title,n=e.import_datetime,r=e.images,i=r.fixed_width,o=i.height,c=i.width,l=i.url;return{user:t,title:a,date:n,images:r,height:parseFloat(o),width:parseFloat(c),src:l,originalSrc:e.url}}));i((function(e){return e.concat(t)})),y(!1)})).catch((function(e){return console.log(e)}))};Object(n.useEffect)((function(){i(Ee),b(0),_()}),[w]),Object(n.useEffect)((function(){0!==v&&_()}),[v]);var S=Object(n.useRef)(),C=Object(n.useCallback)((function(e){j||(S.current&&S.current.disconnect(),S.current=new IntersectionObserver((function(e){e[0].isIntersecting?(console.log("Last element visible"),b(v+1)):console.log("Last element not visible")}),{threshold:.1}),e&&S.current.observe(e))}),[j]),N=Oe();return r.a.createElement("div",{className:N.root},r.a.createElement("div",{className:N.searchBar},r.a.createElement(g,{onChange:function(e){u(e.target.value)}})),r.a.createElement(ve.a,{variant:"middle"}),r.a.createElement("div",{className:N.list},r.a.createElement(pe,{className:N.root,gifs:a,ref:C})))})),ye=a(87),we=Object(z.b)(null,(function(e){return{alert:function(t){return e(ne(t))}}}))((function(e){var t=e.component,a=e.isAuthenticated,n=void 0!==a&&a,i=e.alert,o=Object(ye.a)(e,["component","isAuthenticated","alert"]);return r.a.createElement(c.b,Object.assign({},o,{render:function(e){return n?r.a.createElement(t,e):(i(re.LOGIN_PROMPT),r.a.createElement(c.a,{to:"/"}))}}))})),_e=Object(s.a)((function(e){return{root:{margin:"5em auto",width:"90%"}}})),Se=Object(c.g)(Object(z.b)((function(e){var t=e.auth.user;return{favorites:e.favorites[t.email]?e.favorites[t.email]:{}}}),null)((function(e){var t=Object.values(e.favorites),a=_e();return r.a.createElement("div",{className:a.root},r.a.createElement(pe,{gifs:t}))}))),Ce=a(34),Ne=a(320),Ie=a(321),xe=a(172),ke=a.n(xe),Pe=Object(s.a)({root:{width:"100%",position:"fixed",bottom:0}}),Re=Object(c.g)((function(e){var t=Pe(),a=r.a.useState(0),n=Object(l.a)(a,2),i=n[0],o=n[1],c=e.location.pathname;return"/"===c&&0!==i?o(0):"/favorites"===c&&1!==i&&o(1),r.a.createElement(Ne.a,{value:i,onChange:function(e,t){o(t)},showLabels:!0,className:t.root},r.a.createElement(Ie.a,{label:"Trending",icon:r.a.createElement(ke.a,null),component:Ce.b,to:"/"}),r.a.createElement(Ie.a,{label:"Favorites",icon:r.a.createElement(R.a,null),component:Ce.b,to:"/favorites"}))})),Te=a(326),Le=a(327),ze=a(89),Ae=a(325),Fe=a(323),Ge=a(324),Me=a(322),Be=Object(s.a)((function(e){return{root:{}}})),Ue=Object(c.g)(Object(z.b)(null,(function(e){return{logout:function(){return e({type:Z})},alert:function(t){return e(ne(t))}}}))((function(e){var t=Be(),a=function(){var t=e.logout,a=e.alert;t(),a(re.LOGOUT),e.history.push("/")};return r.a.createElement(Me.a,{className:t.root,size:"small",color:"primary",onClick:function(){window.gapi.load("auth2",(function(){var e=window.gapi.auth2.init({client_id:"".concat("632950261036-lmln5vcmnoarru8rpj4573l1qlsn3qj6.apps.googleusercontent.com")});e.then((function(){e.signOut().then((function(){e.disconnect(),a()}))}))}))}},"Logout")}))),We=a(328),He=function(e){Object(E.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(v.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).initGoogle=function(e){},e.onSuccess=function(t){var a=e.props,n=a.login,r=a.alert,i=t.getBasicProfile();n({email:i.getEmail(),name:i.getName(),avatar:i.getImageUrl()}),r(re.LOGIN_SUCCESS)},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.gapi.load("auth2",(function(){window.gapi.auth2.init({client_id:"".concat("632950261036-lmln5vcmnoarru8rpj4573l1qlsn3qj6.apps.googleusercontent.com")}).then((function(){window.gapi.signin2.render("google-login",{scope:"profile email",prompt:"consent",longtitle:!1,theme:"light",onsuccess:e.onSuccess,onfailure:e.props.handleLoginFailure})}))}))}},{key:"render",value:function(){return r.a.createElement("div",{id:"google-login"})}}]),a}(r.a.Component),qe=Object(c.g)(Object(z.b)(null,(function(e){return{login:function(t){return e(function(e){return{type:$,user:e}}(t))},alert:function(t){return e(ne(t))}}}))(He));function Je(e){var t=e.children,a=Object(Fe.a)();return r.a.createElement(Ge.a,{appear:!1,direction:"down",in:!a},t)}var De=Object(s.a)((function(e){return{title:{fontStyle:"italic",fontWeight:700},text:{display:"flex",justifyContent:"center",alignItems:"center"},auth:{display:"flex",justifyContent:"flex-end",alignItems:"center"}}})),Ve=Object(z.b)((function(e){return e.auth}),null)((function(e){var t=De(),a=e.isSignedIn,n=e.user,i=a?r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a,{"aria-label":"avatar",src:n.avatar}),r.a.createElement(Ue,null)):r.a.createElement(qe,null);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ae.a,null),r.a.createElement(Je,e,r.a.createElement(Te.a,{position:"sticky",color:"inherit"},r.a.createElement(Le.a,null,r.a.createElement(We.a,{justify:"space-between",container:!0,spacing:0},r.a.createElement(We.a,{item:!0,xs:2,className:t.text},r.a.createElement(ze.a,{variant:"subtitle2",color:"inherit"},"Powered by GIPHY")),r.a.createElement(We.a,{item:!0,xs:8,className:t.text},r.a.createElement(ze.a,{type:"title",color:"inherit",className:t.title},"G I F S !")),r.a.createElement(We.a,{item:!0,xs:2,className:t.auth},i))))),r.a.createElement(Le.a,null))})),Ye=a(173),Ke=a(329),Qe=a(332),Xe=a(331),$e=function(e){var t=e.alertType,a=e.handleClose;switch(t){case re.LOGIN_SUCCESS:return r.a.createElement(Xe.a,{onClose:a,severity:"success"},"Login success!");case re.LOGIN_FAILURE:return r.a.createElement(Xe.a,{onClose:a,severity:"error"},"Error logging in, please try again later");case re.LOGOUT:return r.a.createElement(Xe.a,{onClose:a,severity:"success"},"Logout success!");case re.LOGIN_PROMPT:return r.a.createElement(Xe.a,{onClose:a,severity:"error"},"You need to be signed in to carry out this action.");default:return r.a.createElement("div",null)}},Ze=Object(z.b)((function(e){return e.alert}),(function(e){return{alert:function(t){return e(ne(t))}}}))((function(e){var t=e.alertType,a=e.alert;return r.a.createElement(Qe.a,{open:t!==re.None,autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"}},r.a.createElement($e,{alertType:t,handleClose:function(){a(re.NONE)}}))})),et=Object(Ye.a)({typography:{fontFamily:"Helvetica Neue"}}),tt=Object(z.b)((function(e){return e.auth}),null)((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ke.a,{theme:et},r.a.createElement(Ve,null),r.a.createElement(c.d,null,r.a.createElement(c.b,{exact:!0,path:"/",component:je,isAuthenticated:e.isSignedIn}),r.a.createElement(we,{exact:!0,path:"/favorites",component:Se,isAuthenticated:e.isSignedIn})),r.a.createElement(Ze,null),r.a.createElement(Re,null)))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var at=a(71),nt={isSignedIn:!1,user:""},rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $:return Object(p.a)(Object(p.a)({},e),{},{isSignedIn:!0,user:t.user});case Z:return Object(p.a)(Object(p.a)({},e),nt);default:return e}},it=a(130),ot=a(76),ct={},lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee:var a=t.item.originalSrc;return Object(p.a)(Object(p.a)({},e),{},Object(ot.a)({},t.user,Object(p.a)(Object(p.a)({},e[t.user]),{},Object(ot.a)({},a,t.item))));case te:var n=t.item.originalSrc,r=t.user,i=e[r],o=Object(ye.a)(e,[r].map(it.a)),c=(i[n],Object(ye.a)(i,[n].map(it.a)));return Object(p.a)(Object(p.a)({},o),{},Object(ot.a)({},t.user,c));default:return e}},st={alertType:re.NONE},ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:return Object(p.a)(Object(p.a)({},e),{},{alertType:t.alertType});default:return e}},mt=Object(at.b)({auth:rt,favorites:lt,alert:ut}),ht=localStorage.getItem("auth")?JSON.parse(localStorage.getItem("auth")):void 0,dt=localStorage.getItem("favorites")?JSON.parse(localStorage.getItem("favorites")):void 0,ft=Object(at.c)(mt,{auth:ht,favorites:dt});ft.subscribe((function(){var e=ft.getState().auth,t=ft.getState().favorites;localStorage.setItem("auth",JSON.stringify(e)),localStorage.setItem("favorites",JSON.stringify(t))}));var gt=ft;o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(z.a,{store:gt},r.a.createElement(Ce.a,null,r.a.createElement(tt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[181,1,2]]]);
//# sourceMappingURL=main.003d2726.chunk.js.map